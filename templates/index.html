<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영어 학습 플레이어</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- VSCode Style Activity Bar -->
    <div class="activity-bar">
        <button class="activity-item active" onclick="showPanel('media')" title="미디어 파일">
            📁
        </button>
        <button class="activity-item" onclick="showPanel('subtitle')" title="자막 생성">
            📝
        </button>
        <button class="activity-item" onclick="showPanel('analysis')" title="분석 (번역, Spacy, 어휘)">
            🔍
        </button>
        <button class="activity-item" onclick="showPanel('mp3extract')" title="MP3 추출">
            🎵
        </button>
        <button class="activity-item" onclick="showPanel('mp4extract')" title="MP4 추출">
            🎬
        </button>
    </div>
    
    <!-- Left Sidebar -->
    <div class="sidebar" id="leftSidebar">
        <div class="sidebar-header" id="sidebarHeader">
            <span>자막 생성</span>
            <button class="sidebar-toggle" onclick="toggleLeftSidebar()" title="사이드바 숨김/보이기">×</button>
        </div>
        <div class="sidebar-resizer" id="leftSidebarResizer"></div>
        <div class="sidebar-content" id="sidebarContent">
            <!-- 미디어 파일 패널 -->
            <div id="mediaPanel">
                <button onclick="showUploadSection()" style="width: 100%; padding: 10px; margin-bottom: 15px; background: #0e639c; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                    ➕ 새 파일 업로드
                </button>
                
                <!-- 미디어 목록 -->
                <div class="media-list-section">
                    <h3>📚 미디어 목록</h3>
                    <div id="mediaList" style="margin-top: 10px;"></div>
                </div>
            </div>
            
            <!-- 자막 생성 패널 -->
            <div id="subtitlePanel" style="display: none;">
                <div class="subtitle-generation-section">
                    <h3>📝 자막 생성</h3>
                    <div id="generationStatus" style="margin: 10px 0; color: #858585;"></div>
                    <div id="subtitleGenerationContent">
                        <!-- 자막 생성 버튼들이 여기에 표시됩니다 -->
                    </div>
                </div>
            </div>
            
            <!-- 분석 패널 -->
            <div id="analysisPanel" style="display: none;">
                <h3>🔍 분석 도구</h3>
                <div style="margin: 15px 0;">
                    <button onclick="performTranslation()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #6a4c93; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        🌍 번역
                    </button>
                    <button onclick="performSpacyAnalysis()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #2196F3; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        🧐 Spacy 분석
                    </button>
                    <button onclick="performVocabularyAnalysis()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        📚 어휘 분석
                    </button>
                </div>
            </div>
            
            <!-- MP3 추출 패널 -->
            <div id="mp3extractPanel" style="display: none;">
                <h3>🎵 MP3 추출</h3>
                <div style="margin: 15px 0;">
                    <button onclick="extractSingleMP3()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        🎵 현재 문장 MP3 추출
                    </button>
                    <button onclick="extractBookmarkedMP3()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        ⭐ 북마크 문장 MP3 추출
                    </button>
                    <button onclick="extractAllMP3()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #9c27b0; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        📦 전체 MP3 추출
                    </button>
                </div>
            </div>
            
            <!-- MP4 추출 패널 -->
            <div id="mp4extractPanel" style="display: none;">
                <h3>🎬 MP4 추출</h3>
                <div style="margin: 15px 0;">
                    <div style="background: #2d2d30; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                        <h4 style="margin-bottom: 10px; color: #cccccc;">자막 옵션</h4>
                        <label style="display: block; padding: 5px 0; color: #cccccc; cursor: pointer;">
                            <input type="checkbox" id="englishSub" checked style="margin-right: 8px;">
                            🇺🇸 영어 자막
                        </label>
                        <label style="display: block; padding: 5px 0; color: #cccccc; cursor: pointer;">
                            <input type="checkbox" id="koreanSub" style="margin-right: 8px;">
                            🇰🇷 한글 자막
                        </label>
                    </div>
                    <button onclick="extractSingleMP4()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        🎬 현재 문장 MP4 추출
                    </button>
                    <button onclick="extractBookmarkedMP4()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #ff9800; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        ⭐ 북마크 문장 MP4 추출
                    </button>
                    <button onclick="extractAllMP4()" style="width: 100%; padding: 10px; margin-bottom: 10px; background: #673ab7; color: white; border: none; border-radius: 5px; cursor: pointer;">
                        📦 전체문장분할 MP4 추출
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <main class="main-content">
        <div id="uploadSection" class="upload-area">
            <h3>📁 미디어 파일 업로드</h3>
            
            <div style="margin-bottom: 15px;">
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 1.2em; color: #cccccc; margin-bottom: 10px;">
                        📁 파일을 여기로 드래그하거나 클릭하여 선택하세요
                    </div>
                    <input type="file" id="fileInput" accept="audio/mp3,audio/mpeg,audio/wav,audio/mp4,audio/m4a,audio/ogg,video/mp4,video/avi,video/mov,video/mkv,video/webm,video/x-flv">
                </div>
            </div>
        </div>

        <!-- Media Player -->
        <div class="media-player" id="mediaPlayerDiv" style="display: none;">
            <audio id="audioPlayer" controls style="width: 100%; display: none;"></audio>
            <video id="videoPlayer" controls style="width: 100%; display: none;"></video>
        </div>

        <!-- Processing Options -->
        <div id="processingOptions" style="display: none;">
            <h3>🎤 자막 생성 옵션</h3>
            <div style="background: #2d2d30; padding: 20px; border-radius: 8px; margin: 20px 0;">
                <button id="generateSubtitlesBtn" onclick="generateSubtitles()" style="width: 100%; padding: 15px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1em; margin-bottom: 10px;">
                    🎤 Whisper로 자막 생성
                </button>
                <div id="generationStatus" style="margin-top: 15px; padding: 10px; background: #1e1e1e; border-radius: 5px; color: #858585; min-height: 20px;"></div>
            </div>
        </div>

        <!-- Sentences Display -->
        <div id="sentencesDisplay"></div>
    </main>
    
    <!-- Right Sidebar -->
    <div class="right-sidebar" id="rightSidebar">
        <div class="right-sidebar-header">
            <span>문장 목록</span>
            <button class="sidebar-toggle" onclick="toggleRightSidebar()" title="사이드바 숨김/보이기">×</button>
        </div>
        <div class="right-sidebar-resizer" id="rightSidebarResizer"></div>
        <div class="right-sidebar-content">
        
            <!-- 문장 검색 -->
            <div class="search-area" style="margin-bottom: 20px;">
                <h3>문장 검색</h3>
                <input type="text" id="searchInput" placeholder="3글자 이상 입력하면 자동 검색..." 
                       style="width: 100%; padding: 10px; border: 1px solid #444444; background: #2d2d30; color: #cccccc; border-radius: 3px;">
                <div id="searchResults" style="margin-top: 10px; color: #858585;"></div>
            </div>
            
            <!-- 문장 목록 -->
            <div id="sentenceList"></div>
            
            <!-- 북마크된 문장 -->
            <div class="bookmarked-panel">
                <h3>⭐ 북마크된 문장</h3>
                <div id="bookmarkedList"></div>
            </div>
        </div>
    </div>

    <script type="module" src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>